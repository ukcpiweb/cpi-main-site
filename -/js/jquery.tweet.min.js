(function(a){a.fn.tweet=function(f){var e=a.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:"i said,",auto_join_text_ed:"i",auto_join_text_ing:"i am",auto_join_text_reply:"i replied to",auto_join_text_url:"i was looking at",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join}{text}",comparator:function(h,g){return g.tweet_time-h.tweet_time},filter:function(g){return true}},f);a.fn.extend({linkUrl:function(){var g=[];var h=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;this.each(function(){g.push(this.replace(h,function(j){var i=(/^[a-z]+:/i).test(j)?j:"http://"+j;return'<a href="'+i+'">'+j+"</a>"}))});return a(g)},linkUser:function(){var g=[];var h=/[\@]+(\w+)/gi;this.each(function(){g.push(this.replace(h,'@<a href="http://'+e.twitter_url+'/$1">$1</a>'))});return a(g)},linkHash:function(){var h=[];var i=/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi;var g=(e.username&&e.username.length==1)?"&from="+e.username.join("%2BOR%2B"):"";this.each(function(){h.push(this.replace(i,' <a href="http://'+e.twitter_search_url+"/search?q=&tag=$1&lang=all"+g+'">#$1</a>'))});return a(h)},capAwesome:function(){var g=[];this.each(function(){g.push(this.replace(/\b(awesome)\b/gi,'<span class="awesome">$1</span>'))});return a(g)},capEpic:function(){var g=[];this.each(function(){g.push(this.replace(/\b(epic)\b/gi,'<span class="epic">$1</span>'))});return a(g)},makeHeart:function(){var g=[];this.each(function(){g.push(this.replace(/(&lt;)+[3]/gi,"<tt class='heart'>&#x2665;</tt>"))});return a(g)}});function b(g){return Date.parse(g.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))}function d(g){var i=(arguments.length>1)?arguments[1]:new Date();var j=parseInt((i.getTime()-g)/1000,10);var h="";if(j<60){h=j+" seconds ago"}else{if(j<120){h="a minute ago"}else{if(j<(45*60)){h=(parseInt(j/60,10)).toString()+" minutes ago"}else{if(j<(2*60*60)){h="an hour ago"}else{if(j<(24*60*60)){h=""+(parseInt(j/3600,10)).toString()+" hours ago"}else{if(j<(48*60*60)){h="a day ago"}else{h=(parseInt(j/86400,10)).toString()+" days ago"}}}}}}return"about "+h}function c(){var h=("https:"==document.location.protocol?"https:":"http:");var g=(e.fetch===null)?e.count:e.fetch;if(e.list){return h+"//"+e.twitter_api_url+"/1/"+e.username[0]+"/lists/"+e.list+"/statuses.json?page="+e.page+"&per_page="+g+"&callback=?"}else{if(e.favorites){return h+"//"+e.twitter_api_url+"/favorites/"+e.username[0]+".json?page="+e.page+"&count="+e.count+"&callback=?"}else{if(e.query===null&&e.username.length==1){return h+"//"+e.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+e.username[0]+"&count="+g+(e.retweets?"&include_rts=1":"")+"&page="+e.page+"&callback=?"}else{var i=(e.query||"from:"+e.username.join(" OR from:"));return h+"//"+e.twitter_search_url+"/search.json?&q="+encodeURIComponent(i)+"&rpp="+g+"&page="+e.page+"&callback=?"}}}}return this.each(function(h,l){var k=a('<ul class="tweet_list">').appendTo(l);var j='<p class="tweet_intro">'+e.intro_text+"</p>";var g='<p class="tweet_outro">'+e.outro_text+"</p>";var n=a('<p class="loading">'+e.loading_text+"</p>");if(e.username&&typeof(e.username)=="string"){e.username=[e.username]}var m=function(p){if(typeof e.template==="string"){var i=e.template;for(var o in p){var q=p[o];i=i.replace(new RegExp("{"+o+"}","g"),q===null?"":q)}return i}else{return e.template(p)}};if(e.loading_text){a(l).append(n)}a(l).bind("load",function(){a.getJSON(c(),function(i){if(e.loading_text){n.remove()}if(e.intro_text){k.before(j)}k.empty();var o=a.map(i.results||i,function(K){var H=e.join_text;if(e.join_text=="auto"){if(K.text.match(/^(@([A-Za-z0-9-_]+)) .*/i)){H=e.auto_join_text_reply}else{if(K.text.match(/(^\w+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+) .*/i)){H=e.auto_join_text_url}else{if(K.text.match(/^((\w+ed)|just) .*/im)){H=e.auto_join_text_ed}else{if(K.text.match(/^(\w*ing) .*/i)){H=e.auto_join_text_ing}else{H=e.auto_join_text_default}}}}}var x=K.from_user||K.user.screen_name;var F=K.source;var C="http://"+e.twitter_url+"/"+x;var q=e.avatar_size;var y=K.profile_image_url||K.user.profile_image_url;var L="http://"+e.twitter_url+"/"+x+"/status/"+K.id_str;var B=(typeof(K.retweeted_status)!="undefined");var r=B?K.retweeted_status.user.screen_name:null;var u=b(K.created_at);var N=d(u);var t=B?("RT @"+r+" "+K.retweeted_status.text):K.text;var z=a([t]).linkUrl().linkUser().linkHash()[0];var M='<a class="tweet_user" href="'+C+'">'+x+"</a>";var D=((e.join_text)?('<span class="tweet_join"> '+H+" </span>"):" ");var J=(q?('<a class="tweet_avatar" href="'+C+'"><img src="'+y+'" height="'+q+'" width="'+q+'" alt="'+x+'\'s avatar" title="'+x+'\'s avatar" border="0"/></a>'):"");var w='<span class="tweet_time"><a href="'+L+'" title="view tweet on twitter">'+N+"</a></span>";var A='<span class="tweet_text">'+a([z]).makeHeart().capAwesome().capEpic()[0]+"</span>";var I="http://"+e.twitter_url+"/intent/tweet?in_reply_to="+K.id_str;var E="http://"+e.twitter_url+"/intent/retweet?tweet_id="+K.id_str;var p="http://"+e.twitter_url+"/intent/favorite?tweet_id="+K.id_str;var v='<a class="tweet_action tweet_reply" href="'+I+'">reply</a>';var G='<a class="tweet_action tweet_retweet" href="'+E+'">retweet</a>';var s='<a class="tweet_action tweet_favorite" href="'+p+'">favorite</a>';return{item:K,screen_name:x,user_url:C,avatar_size:q,avatar_url:y,source:F,tweet_url:L,tweet_time:u,tweet_relative_time:N,tweet_raw_text:t,tweet_text:z,retweet:B,retweeted_screen_name:r,user:M,join:D,avatar:J,time:w,text:A,reply_url:I,favorite_url:p,retweet_url:E,reply_action:v,favorite_action:s,retweet_action:G}});o=a.grep(o,e.filter).sort(e.comparator).slice(0,e.count);k.append(a.map(o,function(p){return"<li>"+m(p)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");if(e.outro_text){k.after(g)}a(l).trigger("loaded").trigger((o.length===0?"empty":"full"));if(e.refresh_interval){window.setTimeout(function(){a(l).trigger("load")},1000*e.refresh_interval)}})}).trigger("load")})}})(jQuery);